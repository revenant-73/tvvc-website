<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firebase Test 2</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }
    button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin: 10px 0;
    }
    button:hover {
      background-color: #45a049;
    }
    pre {
      background-color: #f5f5f5;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    .success {
      color: green;
      font-weight: bold;
    }
    .error {
      color: red;
      font-weight: bold;
    }
    #status {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>Firebase Connection Test 2</h1>
  
  <p>This page tests the connection to Firebase Firestore.</p>
  
  <form id="test-form">
    <div>
      <label for="player-name">Player Name:</label>
      <input type="text" id="player-name" name="playerName" value="Test Player" required>
    </div>
    <div>
      <label for="birth-date">Birth Date:</label>
      <input type="date" id="birth-date" name="birthDate" value="2010-01-01" required>
    </div>
    <div>
      <label for="age-group">Age Group:</label>
      <select id="age-group" name="ageGroup" required>
        <option value="14U">14U</option>
        <option value="16U">16U</option>
        <option value="18U">18U</option>
      </select>
    </div>
    <div>
      <label for="position">Position:</label>
      <select id="position" name="position" required>
        <option value="Outside Hitter">Outside Hitter</option>
        <option value="Middle Blocker">Middle Blocker</option>
        <option value="Setter">Setter</option>
        <option value="Libero">Libero</option>
      </select>
    </div>
    <div>
      <label for="parent-email">Parent Email:</label>
      <input type="email" id="parent-email" name="parentEmail" value="test@example.com" required>
    </div>
    <div>
      <label for="parent-phone">Parent Phone:</label>
      <input type="tel" id="parent-phone" name="parentPhone" value="555-123-4567" required>
    </div>
    
    <button type="submit">Submit Form</button>
  </form>
  
  <div id="status"></div>
  
  <h2>Console Output:</h2>
  <pre id="console"></pre>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  
  <script>
    // Log function to display in our custom console
    function log(message, type = 'info') {
      const consoleElem = document.getElementById('console');
      const time = new Date().toLocaleTimeString();
      
      // Also log to browser console
      console.log(`${time}: ${message}`);
      
      // Add to our visual console
      consoleElem.innerHTML += `[${time}] ${message}\n`;
      
      // Auto-scroll to bottom
      consoleElem.scrollTop = consoleElem.scrollHeight;
    }
    
    // Show status message
    function showStatus(message, isSuccess = true) {
      const statusElem = document.getElementById('status');
      statusElem.innerHTML = `<p class="${isSuccess ? 'success' : 'error'}">${message}</p>`;
    }
    
    // Initialize Firebase
    try {
      log('Initializing Firebase...');
      
      const firebaseConfig = {
        apiKey: "AIzaSyDmsZlmti2s_-tnmfzu2dl3JXHc-O_MFIo",
        authDomain: "tvvc-website.firebaseapp.com",
        projectId: "tvvc-website",
        storageBucket: "tvvc-website.firebasestorage.app",
        messagingSenderId: "235626883938",
        appId: "1:235626883938:web:109885d0682b9080bd1a3b"
      };
      
      firebase.initializeApp(firebaseConfig);
      
      log('Firebase initialized successfully');
      
      // Initialize Firestore
      const db = firebase.firestore();
      log('Firestore initialized');
      
      // Collection reference
      const registrationsCollection = db.collection('tryout-registration-2025');
      log(`Collection reference created: ${registrationsCollection.path}`);
      
      // Form submit handler
      document.getElementById('test-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        log('Form submitted');
        
        // Get form data
        const formData = new FormData(this);
        const formDataObj = {};
        
        formData.forEach((value, key) => {
          formDataObj[key] = value;
          log(`Form field: ${key} = ${value}`);
        });
        
        // Add timestamp
        formDataObj.timestamp = new Date().toISOString();
        
        log(`Attempting to add document with data: ${JSON.stringify(formDataObj)}`);
        
        // Save to Firestore
        registrationsCollection.add(formDataObj)
          .then((docRef) => {
            log(`Success! Document added with ID: ${docRef.id}`, 'success');
            showStatus(`Document added successfully with ID: ${docRef.id}`);
          })
          .catch((error) => {
            log(`Error adding document: ${error}`, 'error');
            showStatus(`Error adding document: ${error.message}`, false);
          });
      });
      
    } catch (error) {
      log(`Error during initialization: ${error}`, 'error');
      showStatus(`Error during initialization: ${error.message}`, false);
    }
  </script>
</body>
</html>